subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>% opt_stylize(style = 3) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_column_labels())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_column_labels())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_)
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31")
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025"))
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,
locations = cells_row_groups()) %>%
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,
locations = cells_row_groups())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,
locations = cells_row_groups())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#ffeaa7"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#ffeaa7"),cell_text(weight = "bold")) ,
locations = cells_row_groups())  %>%
summary_rows(groups =everything() ,columns =c(2:4) ,fns =list(Avg=~mean(.))  )
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
sp_forecast_gt<-
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_tbl
detect_last_tbl
detect_last_tbl
detect_last_tbl %>% gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,4),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = c(5,6),decimals = 0) %>%
tab_header(title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2024",group = "2024",rows = date>"2024-1-1")   %>%
tab_row_group(label = "2023",group = "2023",rows = date<"2023-12-31") %>%
row_group_order(groups = c("2023","2024")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_tbl %>% gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,4),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = c(5,6),decimals = 0) %>%
tab_header(title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2024",group = "2024",rows = date>"2024-01-01")   %>%
tab_row_group(label = "2023",group = "2023",rows = date<"2023-12-31") %>%
row_group_order(groups = c("2023","2024")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_tbl
detect_last_tbl %>%rename(date=months)%>% gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,4),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = c(5,6),decimals = 0) %>%
tab_header(title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2024",group = "2024",rows = date > "2024-01-01")   %>%
tab_row_group(label = "2023",group = "2023",rows = date < "2023-12-31") %>%
row_group_order(groups = c("2023","2024")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_tbl %>%rename(date=months)%>% gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,4),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = c(5,6),decimals = 0) %>%
tab_header(title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2024",group = "2024",rows = date >= "2024-01-01")   %>%
tab_row_group(label = "2023",group = "2023",rows = date < "2023-12-31") %>%
row_group_order(groups = c("2023","2024")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_gt<-
detect_last_tbl %>%rename(date=months)%>% gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,4),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = c(5,6),decimals = 0) %>%
tab_header(title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2024",group = "2024",rows = date >= "2024-01-01")   %>%
tab_row_group(label = "2023",group = "2023",rows = date < "2023-12-31") %>%
row_group_order(groups = c("2023","2024")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
autoplot(mns_rfor)
library(rmdformats)
library(prettydoc)
library(hrbrthemes)
library(pacman)
p_load("dplyr","tidyr","lubridate","janitor","data.table","DT",
"gt","forecast","stringr","gmodels","scales","ggplot2","GGally","plotly",
"quantmod","openxlsx","readxl","tseries","formattable","tibble")
getSymbols("^GSPC",from="2005-01-01")
sp<-
rownames_to_column(data.frame(GSPC)) %>% select(1,5) %>% clean_names() %>%
rename(date=rowname,price=gspc_close) %>%
mutate(date=as.Date(date))%>% mutate(months=round_date(date,"month"))
mns<-sp %>% group_by(months) %>% summarize(price=mean(price))
mns_ts<-ts(mns$price,start = c(2005,1),end = c(2023,10),frequency = 12)
detect_last_plot<-autoplot(decompose(diff(mns_ts)))
mns_lets<-ets(mns_ts)
mns_lfor<-forecast(mns_lets,h = 12)
mns_lar<-auto.arima(mns_ts)
mns_lfora<-forecast(mns_lar,h = 12)
detect_last_tbl<-
cbind( mns[mns$months>"2023-10-01",],
rownames_to_column(data.frame( mns_lfor))) %>%
select(c(1,2,6,8)) %>%clean_names() %>%
mutate(var80=hi_80/price,var95=hi_95/price)
detect_last_gt<-
detect_last_tbl %>%rename(date=months)%>% gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,4),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = c(5,6),decimals = 0) %>%
tab_header(title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2024",group = "2024",rows = date >= "2024-01-01")   %>%
tab_row_group(label = "2023",group = "2023",rows = date < "2023-12-31") %>%
row_group_order(groups = c("2023","2024")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_chart<-
detect_last_tbl %>% select(c(1:4)) %>%
mutate(months=as.Date(months)) %>%
pivot_longer(!months,names_to = "Levels",values_to = "prices") %>%
mutate(months=as.POSIXct(months)) %>%
ggplot(aes(x=months,y=prices,group = Levels))+
geom_line(aes( color=Levels),size=1)+
geom_point(aes(color=Levels),size=2)+
labs(x="",y="",
title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023")+
scale_y_continuous(labels = comma)+
scale_x_datetime(date_breaks = "month",date_labels ="%b-%y" )+
scale_color_brewer(palette = "Dark2")+theme_bw()+
theme(axis.text.x = element_text(face = "bold",colour = "#2c3e50"),
axis.text.y = element_text(face = "bold",colour = "#2c3e50"),
legend.position =  "top",
title = element_text(face = "bold",colour = "#2c3e50"),
legend.title = element_blank())+
geom_label(aes(label =paste0(round(prices/1000,2),"K")),
nudge_x = 0.25,nudge_y = 0.25,size=2.5,fontface = "bold",color="#2c3e50")
mns_rts<-ts(mns$price,start = c(2005,1),end = c(2024,10),frequency = 12)
mns_rets<-ets(mns_rts)
mns_rfor<-forecast(mns_rets,h = 14)
sp_forecast_tbl<-
cbind(data.frame(date=seq(as.Date("2024-10-01"),len=14,by="month")),
rownames_to_column(data.frame(mns_rfor))) %>% select(c(1,5,7)) %>%
mutate(var=round( (Hi.95/Hi.80)-1,2))
sp_forecast_chart<-
sp_forecast_tbl %>% mutate(date=as.POSIXct(date)) %>%
select(c(1:3)) %>%
pivot_longer(!date,names_to = "Levels",values_to = "prices") %>%
mutate(date=as.POSIXct(date)) %>%
ggplot(aes(x=date,y=prices,group=Levels))+
geom_line(aes(color=Levels),size=2)+
geom_point(aes(color=Levels),size=2.5)+
geom_label(aes(label =paste0(round(prices/1000,2),"K")),
nudge_x = 0.25,nudge_y = 0.25,size=2.5,fontface = "bold",color="#2c3e50")+
labs(x="",y="",
title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle = "Data Focus Period: JAN 2005 - OCT 2024")+
scale_y_continuous(labels = comma)+
scale_x_datetime(date_breaks = "month",date_labels ="%b-%y" )+
scale_color_brewer(palette = "Dark2")+theme_bw()+
theme(axis.text.x = element_text(face = "bold",colour = "#2c3e50"),
axis.text.y = element_text(face = "bold",colour = "#2c3e50"),
legend.position =  "top",
title = element_text(face = "bold",colour = "#2c3e50"),
legend.title = element_blank())
sp_forecast_gt<-
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
ggplotly( detect_last_chart,width = 800)
detect_last_chart
detect_last_chart
detect_last_chart
detect_last_gt
mn_forecast_chart
sp_forecast_chart
sp_forecast_gt
knitr::opts_chunk$set(echo = TRUE)
library(rmdformats)
library(prettydoc)
library(hrbrthemes)
library(pacman)
p_load("dplyr","tidyr","lubridate","janitor","data.table","DT",
"gt","forecast","stringr","gmodels","scales","ggplot2","GGally","plotly",
"quantmod","openxlsx","readxl","tseries","formattable","tibble")
spp<-getSymbols("^GSPC",from="2005-01-01")
sp<-
rownames_to_column(data.frame(GSPC)) %>% select(1,5) %>% clean_names() %>%
rename(date=rowname,price=gspc_close) %>%
mutate(date=as.Date(date))%>% mutate(months=round_date(date,"month"))
mns<-sp %>% group_by(months) %>% summarize(price=mean(price))
mns_ts<-ts(mns$price,start = c(2005,1),end = c(2023,10),frequency = 12)
detect_last_plot<-autoplot(decompose(diff(mns_ts)))
mns_lets<-ets(mns_ts)
mns_lfor<-forecast(mns_lets,h = 12)
mns_lar<-auto.arima(mns_ts)
mns_lfora<-forecast(mns_lar,h = 12)
detect_last_tbl<-
cbind( mns[mns$months>"2023-10-01",],
rownames_to_column(data.frame( mns_lfor))) %>%
select(c(1,2,6,8)) %>%clean_names() %>%
mutate(var80=hi_80/price,var95=hi_95/price)
detect_last_gt<-
detect_last_tbl %>%rename(date=months)%>% gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,4),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = c(5,6),decimals = 0) %>%
tab_header(title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2024",group = "2024",rows = date >= "2024-01-01")   %>%
tab_row_group(label = "2023",group = "2023",rows = date < "2023-12-31") %>%
row_group_order(groups = c("2023","2024")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_chart<-
detect_last_tbl %>% select(c(1:4)) %>%
mutate(months=as.Date(months)) %>%
pivot_longer(!months,names_to = "Levels",values_to = "prices") %>%
mutate(months=as.POSIXct(months)) %>%
ggplot(aes(x=months,y=prices,group = Levels))+
geom_line(aes( color=Levels),size=1)+
geom_point(aes(color=Levels),size=2)+
labs(x="",y="",
title = "Detect Last Year SP500 Prices ETS Model",
subtitle = "Data Focus Period: JAN 2005-OCT 2023")+
scale_y_continuous(labels = comma)+
scale_x_datetime(date_breaks = "month",date_labels ="%b-%y" )+
scale_color_brewer(palette = "Dark2")+theme_bw()+
theme(axis.text.x = element_text(face = "bold",colour = "#2c3e50"),
axis.text.y = element_text(face = "bold",colour = "#2c3e50"),
legend.position =  "top",
title = element_text(face = "bold",colour = "#2c3e50"),
legend.title = element_blank())+
geom_label(aes(label =paste0(round(prices/1000,2),"K")),
nudge_x = 0.25,nudge_y = 0.25,size=2.5,fontface = "bold",color="#2c3e50")
mns_rts<-ts(mns$price,start = c(2005,1),end = c(2024,10),frequency = 12)
mns_rets<-ets(mns_rts)
mns_rfor<-forecast(mns_rets,h = 14)
sp_forecast_tbl<-
cbind(data.frame(date=seq(as.Date("2024-10-01"),len=14,by="month")),
rownames_to_column(data.frame(mns_rfor))) %>% select(c(1,5,7)) %>%
mutate(var=round( (Hi.95/Hi.80)-1,2))
sp_forecast_chart<-
sp_forecast_tbl %>% mutate(date=as.POSIXct(date)) %>%
select(c(1:3)) %>%
pivot_longer(!date,names_to = "Levels",values_to = "prices") %>%
mutate(date=as.POSIXct(date)) %>%
ggplot(aes(x=date,y=prices,group=Levels))+
geom_line(aes(color=Levels),size=2)+
geom_point(aes(color=Levels),size=2.5)+
geom_label(aes(label =paste0(round(prices/1000,2),"K")),
nudge_x = 0.25,nudge_y = 0.25,size=2.5,fontface = "bold",color="#2c3e50")+
labs(x="",y="",
title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle = "Data Focus Period: JAN 2005 - OCT 2024")+
scale_y_continuous(labels = comma)+
scale_x_datetime(date_breaks = "month",date_labels ="%b-%y" )+
scale_color_brewer(palette = "Dark2")+theme_bw()+
theme(axis.text.x = element_text(face = "bold",colour = "#2c3e50"),
axis.text.y = element_text(face = "bold",colour = "#2c3e50"),
legend.position =  "top",
title = element_text(face = "bold",colour = "#2c3e50"),
legend.title = element_blank())
sp_forecast_gt<-
sp_forecast_tbl %>%gt() %>%
cols_label_with(columns = everything(),fn = toupper) %>%
fmt_currency(columns = c(2,3),decimals = 2,currency = "USD") %>%
fmt_date(columns = 1,date_style = "yMMM") %>%
fmt_percent(columns = 4,decimals = 0) %>%
tab_header(title = "Forecasting SP500 Prices ETS Model For Next 14 Months",
subtitle ="Data Focus Period: JAN 2005 - OCT 2024" ) %>%
tab_style(style =cell_text(align = "center",weight = "bold") ,locations = cells_body()) %>%
tab_style(style =list(cell_fill("#2d3436"),cell_text(color="white",align = "center",weight = "bold")) ,locations = cells_column_labels()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_style(style =list(cell_fill("#b2bec3"),cell_text(align = "center",weight = "bold")) ,locations = cells_title()) %>%
tab_row_group(label = "2025",group = "2025",rows = date>"2024-12-31")   %>%
tab_row_group(label = "2024",group = "2024",rows = date<"2024-12-31") %>%
row_group_order(groups = c("2024","2025")) %>%
tab_style(style =list(cell_fill("#fdcb6e"),cell_text(weight = "bold")) ,
locations = cells_row_groups())
detect_last_plot
